---
import Layout from "../layouts/Layout.astro";
---

<Layout>
  <canvas id="renderCanvas" class="h-screen w-screen"></canvas>

  <dialog id="phone_call_modal" class="modal pointer-events-auto bg-black/80 backdrop-blur-md">
    <div class="modal-box bg-transparent shadow-none w-full max-w-md text-center text-white font-sans">
      <div class="flex flex-col items-center gap-4">
        <div class="w-24 h-24 bg-gray-700 rounded-full flex items-center justify-center ring-4 ring-gray-500">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12 text-gray-400">
            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" />
          </svg>
        </div>
        <p id="phone-caller-name" class="text-4xl font-light"></p>
        <p class="text-gray-400">Incoming Call...</p>
      </div>
      <div class="mt-16 flex justify-center">
        <button id="answer-call-btn" class="w-20 h-20 rounded-full bg-green-500 hover:bg-green-600 flex items-center justify-center phone-call-pulse">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-10 h-10">
            <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 002.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 01-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 00-1.091-.852H4.5A2.25 2.25 0 002.25 4.5v2.25z" />
          </svg>
        </button>
      </div>
    </div>
  </dialog>

  <dialog id="dialogue_modal" class="modal pointer-events-auto">
    <div
      class="modal-box ui-panel-modal border border-sky-500/30 shadow-2xl shadow-black/80 rounded-lg"
    >
      <h3
        id="dialogue-speaker"
        class="font-bold text-2xl text-sky-400 holographic-text"
      >
      </h3>
      <div class="divider before:bg-gray-800 after:bg-gray-800 mt-2 mb-4"></div>
      <p id="dialogue-text" class="py-4 text-gray-300 text-lg leading-relaxed">
      </p>
      <div class="modal-action">
        <form method="dialog"><button class="btn">Continue...</button></form>
      </div>
    </div>
    <form method="dialog" class="modal-backdrop"><button>close</button></form>
  </dialog>

  <div
    id="game-hud"
    class="absolute inset-0 pointer-events-none text-white font-['Cinzel'] select-none"
  >
    <div
      class="absolute top-4 sm:top-10 left-1/2 -translate-x-1/2 text-center ui-panel px-4 py-2 sm:px-6 rounded-md border border-gray-800/80 shadow-lg shadow-black/50 animate-fade-in-down backdrop-blur-sm"
      style="animation-delay: 100ms;"
    >
      <p
        id="hud-distance"
        class="text-xl sm:text-2xl tracking-wide font-light text-gray-200 text-shadow-sm"
      >
        ...
      </p>
    </div>

    <div
      class="absolute bottom-4 right-4 pointer-events-auto animate-pop-in flex flex-col sm:flex-row gap-2"
      style="animation-delay: 200ms;"
    >
      <button
        id="info-button"
        class="btn btn-circle ui-panel border border-gray-800/80 hover:border-sky-500/50 shadow-lg hover:shadow-sky-500/20 transition-all duration-300"
      >
        <img src="/quest.png" alt="Quests" class="w-8 h-8" />
      </button>
      <button
        id="map-button"
        class="btn btn-circle ui-panel border border-gray-800/80 hover:border-sky-500/50 shadow-lg hover:shadow-sky-500/20 transition-all duration-300"
      >
        <span class="text-2xl">üó∫Ô∏è</span>
      </button>
    </div>

    <div
      id="waypoint"
      class="hidden absolute rounded-full pointer-events-none animate-pulse"
      style="transform: translate(-50%, -50%); border-color: rgba(239, 68, 68, 0.8);"
    >
      <div class="w-10 h-10 border-4 rounded-full"></div>
    </div>
  </div>

  <script>
    import "../assets/scripts/main.ts";
  </script>
  <script is:inline>
    document.addEventListener("astro:page-load", () => {});
  </script>
</Layout>

<style is:global>
  @import url("https://fonts.googleapis.com/css2?family=Cinzel:wght@300;400;500;600;700;800;900&display=swap");

  .ui-panel {
    background-color: rgba(17, 24, 39, 0.7);
    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAUVBMVEWFhYWDg4N3d3dtbW17e3t1dXWBgYGHh4d5eXlzc3OLi4ubm5uVlZWPj4+NjY19fX2JiYl/f39tbW1+fn5oaGhxcXGnpaWEhISNjY1oampoampaAAAAEnRSTlMAwDDw8K9w8DC/wOCf8NAg4OCf4D01rAAAAIZJREFUeNrtlN0RgkAQBdeuUFxAXDbU/3/B2t1wdqhyAq/f4CxgAAMD025w3k3/WKvbwRfej3gWb6S3a5nO5lNFY+9yGaSxr1zT6k46k8/Yj9cr3MgnDk2hS269T2wX6jP2i4CIowjGWEX4LGX8M1+qgL8a4U2xY61Y7AAAAABJRU5ErkJggg==");
  }
  .ui-panel-modal {
    background-color: rgba(17, 24, 39, 0.9);
    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAUVBMVEWFhYWDg4N3d3dtbW17e3t1dXWBgYGHh4d5eXlzc3OLi4ubm5uVlZWPj4+NjY19fX2JiYl/f39tbW1+fn5oaGhxcXGnpaWEhISNjY1oampoampaAAAAEnRSTlMAwDDw8K9w8DC/wOCf8NAg4OCf4D01rAAAAIZJREFUeNrtlN0RgkAQBdeuUFxAXDbU/3/B2t1wdqhyAq/f4CxgAAMD025w3k3/WKvbwRfej3gWb6S3a5nO5lNFY+9yGaSxr1zT6k46k8/Yj9cr3MgnDk2hS269T2wX6jP2i4CIowjGWEX4LGX8M1+qgL8a4U2xY61Y7AAAAABJRU5ErkJggg==");
  }
  .custom-scrollbar::-webkit-scrollbar {
    width: 8px;
  }
  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }
  .custom-scrollbar::-webkit-scrollbar-thumb {
    background: #374151;
    border-radius: 8px;
  }
  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: #4b5563;
  }
  .holographic-text {
    text-shadow:
      0 0 5px rgba(0, 191, 255, 0.3),
      0 0 10px rgba(0, 191, 255, 0.2);
  }
  .text-shadow-sm {
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
  }
  .quest-item.active {
    background-color: rgba(55, 65, 81, 0.7);
    box-shadow:
      inset 0 0 10px rgba(0, 191, 255, 0.2),
      0 0 10px rgba(0, 191, 255, 0.2);
    border-color: rgba(0, 191, 255, 0.5) !important;
  }
  .quest-item {
    border: 1px solid transparent;
  }
  @keyframes fade-in-down {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  .animate-fade-in-down {
    animation: fade-in-down 0.4s ease-out forwards;
  }
  @keyframes pop-in {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }
  .animate-pop-in {
    animation: pop-in 0.3s ease-out forwards;
  }
  .tracking-super-wide {
    letter-spacing: 0.3em;
  }
  @keyframes pulse-glow {
    0%,
    100% {
      box-shadow:
        0 0 10px rgba(251, 191, 36, 0.3),
        0 0 20px rgba(251, 191, 36, 0.2);
    }
    50% {
      box-shadow:
        0 0 20px rgba(251, 191, 36, 0.6),
        0 0 40px rgba(251, 191, 36, 0.4);
    }
  }
  .phone-call-pulse {
    animation: pulse-glow 2s infinite;
  }
</style>
