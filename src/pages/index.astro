---
import Layout from "../layouts/Layout.astro";
---

<Layout>
  <canvas id="renderCanvas" class="h-screen w-screen"></canvas>

  <div
    id="game-hud"
    class="absolute inset-0 pointer-events-none text-white font-['Cinzel'] select-none"
  >
    <!-- Quest Tracker (collapsed / expandable) -->
    <div
      id="quest-tracker"
      class="absolute top-8 flex left-8 pointer-events-auto"
    >
      <div
        id="quest-tracker-header"
        class="flex items-center gap-2 cursor-pointer px-2 py-1 transition-opacity duration-300 opacity-60 hover:opacity-100"
      >
        <h2
          id="hud-quest-title"
          class="text-lg uppercase tracking-wide font-medium hud-glow"
        >
        </h2>
      </div>
      <div
        id="quest-tracker-content"
        class="overflow-hidden max-h-0 pl-6 border-l border-white/10 mt-1"
      >
        <p
          id="hud-quest-objective"
          class="pt-1 pb-2 text-sm leading-snug text-gray-400"
        >
        </p>
      </div>
    </div>

    <!-- Distance / Marker (Center Top) -->
    <div class="absolute top-8 left-1/2 -translate-x-1/2 text-center">
      <p id="hud-distance" class="text-xl tracking-widest hud-glow font-light">
      </p>
    </div>

    <!-- Buttons at bottom-left -->
    <div class="absolute bottom-8 left-8 flex gap-4 pointer-events-auto">
      <button
        id="quest-log-toggle"
        class="w-14 h-14 flex items-center justify-center bg-black/30 rounded-full border border-white/10 backdrop-blur-md transition duration-300 hover:border-accent hover:shadow-accent focus:outline-none"
        aria-label="Open Quest Journal"
      >
        <img src="/quest.png" class="w-7 h-7 opacity-80" alt="Quest Log" />
      </button>
      <!-- you can add more minimal buttons here if needed -->
    </div>
  </div>

  <div
    id="quest-log-panel"
    class="hidden absolute inset-0 pointer-events-auto bg-black/85 backdrop-blur-2xl flex items-center justify-center p-8"
  >
    <div
      class="w-full max-w-6xl h-full max-h-[800px] flex border border-white/10 bg-zinc-950/90 shadow-2xl shadow-black/60 rounded-lg overflow-hidden"
    >
      <!-- Quest List -->
      <div
        id="quest-list-container"
        class="w-1/3 bg-black/30 p-8 border-r border-white/10 overflow-y-auto"
      >
        <h1 class="text-4xl text-accent uppercase tracking-wider mb-6 hud-glow">
          Journal
        </h1>
        <div class="space-y-2"></div>
      </div>

      <!-- Quest Details -->
      <div class="w-2/3 p-10 overflow-y-auto relative">
        <h2
          id="details-quest-title"
          class="text-5xl text-gray-100 mb-4 font-semibold"
        >
          Select a Quest
        </h2>

        <div
          class="w-full h-px bg-gradient-to-r from-accent/70 to-transparent mb-6"
        >
        </div>

        <p
          id="details-quest-riddle"
          class="text-xl leading-relaxed text-gray-400"
        >
          Your journeyâ€™s tales will be written here...
        </p>

        <div
          id="details-success-message"
          class="hidden mt-8 p-6 bg-green-800/30 rounded-md border border-green-500/40"
        >
          <p
            id="details-success-text"
            class="text-xl text-green-300 font-medium"
          >
          </p>
        </div>
      </div>
    </div>

    <button
      id="quest-log-close"
      class="absolute top-8 right-8 w-12 h-12 flex items-center justify-center bg-black/30 rounded-full border border-white/10 transition duration-300 hover:border-accent hover:shadow-accent"
      aria-label="Close Quest Journal"
    >
      <svg
        class="w-6 h-6 text-slate-200"
        fill="none"
        viewBox="0 0 24 24"
        stroke="currentColor"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </button>
  </div>

  <script>
    import "../assets/scripts/main.ts";
  </script>

  <script is:inline>
    document.addEventListener("astro:page-load", () => {
      const tracker = document.getElementById("quest-tracker");
      const header = document.getElementById("quest-tracker-header");
      if (tracker && header) {
        tracker.classList.remove("is-expanded");
        header.addEventListener("click", () => {
          tracker.classList.toggle("is-expanded");
        });
      }
    });
  </script>
</Layout>
